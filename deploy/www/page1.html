<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Page 1 (Vulnerable)</title>
</head>
<body>
<p>Vulnerable Page since mod security disable for this page</p>

<?php
require __DIR__ . '/config.php';

if (isset($_REQUEST['username'])) {
    $username = $_REQUEST['username'];
    $sql = "SELECT * FROM users WHERE username = '" . $username . "'";

    echo "<pre>Executed SQL:\n" . htmlspecialchars($sql) . "</pre>";

    try {
        $stmt = $pdo->query($sql);
        $rows = $stmt->fetchAll();

        if (!empty($rows)) {
            $found = $rows[0]['username'];
            echo "Logged in as " . htmlspecialchars($found);
        } else {
            echo "User not found";
        }
    } catch (Throwable $e) {
        $error = $e->getMessage();
        echo "<div style='color:red'>Error: " . htmlspecialchars($error) . "</div>";
    }
}
?>

<form method="post">
    <input name="username" placeholder="username" required>
    <button type="submit">Login</button>
</form>

</body>
</html>
